{"version":3,"file":"block-board.js","sourceRoot":"","sources":["../src/block-board.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, LitElement, property, Constructor } from \"lit-element\";\nimport { Block, BlockLayout, BlockSet, BlockNode } from \"./types\";\nimport { sharedStyles } from \"./sharedStyles\";\nimport { BlockBoardLayoutEditor } from \"./block-board-layout-editor\";\nimport { ScopedElementsMixin as Scoped } from \"@open-wc/scoped-elements\";\nimport { BlockBoardLayoutRenderer } from \"./block-board-layout-renderer\";\nimport { BlockBoardBlockSelector } from \"./block-board-block-selector\";\nimport { Drawer } from \"scoped-material-components/mwc-drawer\";\nimport { IconButton } from \"scoped-material-components/mwc-icon-button\";\n\nexport class BlockBoard extends (Scoped(\n  LitElement\n) as Constructor<LitElement>) {\n  @property({ type: Boolean }) public editing: boolean = true;\n\n  @property({ type: Array })\n  private _blockSets: Array<BlockSet> = [];\n  \n  set blockSets(blocks: BlockSet[]) {\n    this._blockSets = [...blocks];\n  }\n  get blockSets() {\n    return this._blockSets;\n  }\n\n  get availableBlocks() {\n    const allBlocks = this._blockSets.map((set) => set.blocks);\n    return ([] as Array<Block>).concat(...allBlocks);\n  }\n\n  public initialBlockLayout: BlockNode | undefined = undefined;\n\n  @property({ type: Array })\n  private _blockLayout: BlockNode = this.initialBlockLayout || {\n    direction: \"horizontal\",\n    slots: [undefined, undefined],\n    firstSlotRelativeSize: 0.5,\n  };\n\n  internalIsLayoutEmpty(blockNode: BlockNode): boolean {\n    if (!blockNode) return true;\n    else if ((blockNode as BlockLayout).direction)\n      return (\n        this.internalIsLayoutEmpty((blockNode as BlockLayout).slots[0]) &&\n        this.internalIsLayoutEmpty((blockNode as BlockLayout).slots[1])\n      );\n    return false;\n  }\n\n  isEditingLayoutEmpty() {\n    if (!this.editor) return false;\n    return this.internalIsLayoutEmpty(this.editor.blockLayout);\n  }\n\n  get editor(): BlockBoardLayoutEditor {\n    return this.shadowRoot?.getElementById(\n      \"layout-editor\"\n    ) as BlockBoardLayoutEditor;\n  }\n\n  save(): BlockNode {\n    this._blockLayout = this.editor.blockLayout;\n\n    this.editing = false;\n\n    this.dispatchEvent(\n      new CustomEvent(\"board-saved\", {\n        detail: { blockLayout: this._blockLayout },\n        composed: true,\n        bubbles: true,\n      })\n    );\n\n    return this._blockLayout;\n  }\n\n  renderLayout() {\n    return html`\n      <block-board-layout-renderer\n        style=\"flex: 1;\"\n        .blockLayout=${this._blockLayout}\n        .availableBlocks=${this.availableBlocks}\n      ></block-board-layout-renderer>\n    `;\n  }\n\n  renderEditingMode() {\n    return html`\n      <mwc-drawer style=\"flex: 1;\" hasHeader>\n        <span slot=\"title\"> Draggable blocks </span>\n\n        <div class=\"column\" style=\"margin: 0 16px;\">\n          <div class=\"row\" style=\"justify-content: flex-end;\"></div>\n          <block-board-block-selector\n            .blockSets=${this.blockSets}\n          ></block-board-block-selector>\n        </div>\n\n        <div slot=\"appContent\" class=\"column\" style=\"height: 100%;\">\n          <block-board-layout-editor\n            id=\"layout-editor\"\n            style=\"flex: 1;\"\n            class=\"column\"\n            .blockLayout=${this._blockLayout}\n            .availableBlocks=${this.availableBlocks}\n          ></block-board-layout-editor>\n        </div>\n      </mwc-drawer>\n    `;\n  }\n\n  render() {\n    if (this.editing) return this.renderEditingMode();\n    else return this.renderLayout();\n  }\n\n  static styles = [\n    sharedStyles,\n    css`\n      :host {\n        display: flex;\n      }\n    `,\n  ];\n\n  static get scopedElements() {\n    return {\n      \"mwc-drawer\": Drawer,\n      \"block-board-layout-renderer\": BlockBoardLayoutRenderer,\n      \"block-board-layout-editor\": BlockBoardLayoutEditor,\n      \"block-board-block-selector\": BlockBoardBlockSelector,\n    };\n  }\n}\n"]}